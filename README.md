# gmu (Go Mod Updater)

`gmu` - это универсальный инструмент для управления зависимостями в Go проектах. Он объединяет функциональность обновления feature-версий и локальной замены модулей.

[![Go](https://img.shields.io/badge/go-1.24+-blue)](https://golang.org)
[![License](https://img.shields.io/github/license/wenkaler/gmu)](https://github.com/wenkaler/gmu)

## Описание

Инструмент решает две основные задачи:
1. **Update**: Автоматическое обновление зависимостей до специфических версий (например, feature-ветки вида `vX.Y.Z-task-1234`).
2. **Replace**: Быстрая подмена (replace) зависимостей на локальные версии для разработки.

## Установка

```bash
go install github.com/wenkaler/gmu/cmd/gmu@latest
```

Или сборка из исходников:

```bash
git clone https://github.com/wenkaler/gmu.git
cd gmu
go build -o gmu ./cmd/gmu
```

## Использование

### 1. Обновление зависимостей (Update)

Сканирует `go.mod` и обновляет модули, соответствующие регулярному выражению, до версии с указанным суффиксом.

```bash
# Обновить модули до версии с суффиксом -1234 (например v0.0.0-20230101-1234)
gmu -f 1234

# Обновить и применить изменения (go get)
gmu -f 1234 -u
```

Флаги:
- `-f`, `--feature`: Суффикс версии (номер задачи).
- `-u`: Применить обновления (выполнить `go get`).
- `-r`: Регулярное выражение для фильтрации модулей (переопределяет конфиг).
- `-e`: Исключить модули по регулярному выражению.

### 2. Локальная замена (Replace)

Удобная обертка для добавления директивы `replace` в `go.mod`. Ищет локальную копию модуля в `GOPATH`.

```bash
# Найти модуль по части названия и заменить на локальный путь
gmu replace my-lib

# Очистить все replace директивы
gmu replace --clear
# или
gmu replace -cl
```

### 3. Просмотр замен

```bash
gmu show
```

## Конфигурация

Вы можете создать файл `config.yaml` в директории запуска для настройки параметров по умолчанию (для команды update):

```yaml
target_regex: "^github.com/mycompany/.*"
exclude_patterns:
  - ".*-api$"
```

## Структура проекта

- `cmd/gmu`: Точка входа в приложение.
- `internal/update`: Логика обновления версий.
- `internal/replace`: Логика локальных замен.
- `internal/config`: Загрузка конфигурации.
- `internal/logger`: Логирование.

---
**Примечание**: Проект является объединением утилит `goreplace` и `gmu`.
